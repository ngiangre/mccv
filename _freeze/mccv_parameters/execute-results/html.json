{
  "hash": "1f9df23ca8dab809c064b3df808f10cf",
  "result": {
    "markdown": "---\ntitle: \"Learning Parameters\"\nformat:\n  html:\n    code-fold: true\n    code-summary: 'Show The Code'\n---\n\n::: {.cell hash='mccv_parameters_cache/html/unnamed-chunk-1_82b2ee043e496b1121b5ec6a64d6f717'}\n\n```{.python .cell-code}\nimport numpy as np\n\nN=100\nnp.random.seed(0)\nZ1 = np.random.beta(2,3,size=N,)\nnp.random.seed(0)\nZ2 = np.random.beta(2,2.5,size=N)\nZ = np.concatenate([Z1,Z2])\n\nimport scipy as sc\nY = np.concatenate([np.repeat(0,N),np.repeat(1,N)])\n\nimport pandas as pd\ndf = pd.DataFrame(data={'Y' : Y,'Z' : Z})\ndf.index.name = 'pt'\n```\n:::\n\n::: {.cell hash='mccv_parameters_cache/html/unnamed-chunk-2_5dd6406c04bd5d13e0cc21d5a203d2b6'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndf <- tibble::tibble(\n    Y = reticulate::py$Y,\n    Z = reticulate::py$Z\n)\ndf[['Y']] <- factor(df$Y,levels=c(0,1))\n\ndf %>% \n    ggplot(aes(Y,Z)) +\n    geom_boxplot(outlier.size = NA,alpha=0,linewidth=2) +\n    geom_point(position = position_jitter(width = .2),pch=21,fill='gray',size=3) +\n    labs(x = \"Response\",y=\"Predictor\") +\n    theme_bw(base_size = 16)\n```\n\n::: {.cell-output-display}\n![](mccv_parameters_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='mccv_parameters_cache/html/unnamed-chunk-3_d46da564a9ea4c2402157a7420dda8c8'}\n\n```{.python .cell-code}\nimport mccv\nimport pandas as pd\n\nmccv_obj = mccv.mccv(num_bootstraps=200,n_jobs=4)    \nmccv_obj.set_X(df[['Z']])\nmccv_obj.set_Y(df[['Y']])\n\nparam_dfs=[]\nfor seed in range(200):\n    retrained_fit = mccv_obj.mccv(seed)[1]['Logistic Regression'].__dict__\n    param_dict = {k : retrained_fit[k].reshape(-1)[0] for k in ('coef_','intercept_')}\n    param_df = pd.DataFrame.from_dict(param_dict,orient='index',dtype='object',columns=[seed])\n    param_dfs.append(param_df)\nretrained_parameters_df = pd.concat(param_dfs,axis=1).T\nretrained_parameters_df.index.name='seed'\nretrained_parameters_df.reset_index(inplace=True)\n```\n:::\n\n::: {.cell hash='mccv_parameters_cache/html/unnamed-chunk-4_e191f076ac24db0892304afcbfe7c3e3'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nplot_dat <- \n    reticulate::py$retrained_parameters_df %>% \n    pivot_longer(\n        cols = contains('_')\n    ) %>% \n    mutate(\n        seed = as.integer(seed),\n        name = factor(name,levels=c(\"intercept_\",\"coef_\"),labels=c(\"Intercept\",\"Coefficient\")),\n        value = as.double(value)\n        )\n\np <- \n    plot_dat %>% \n    ggplot(aes(name,value,group=seed)) +\n    geom_line() +\n    scale_x_discrete(\n        expand = expansion(0.01,0.01),\n        name=NULL\n    ) +\n    scale_y_continuous(\n        name=\"Parameter Values\"\n    ) +\n    labs(caption='Estimated Parameters From 200 Logistic Regression Bootstraps') +\n    theme_bw(base_size = 20) +\n    theme(\n        axis.text.x = element_text(angle=45,hjust=1,vjust=1)\n    )\n\np + \n    stat_summary(fun.y=mean,color='red',geom='line',aes(group=1),linewidth=3) +\n    labs(caption='Estimated Parameters From 200 Logistic Regression Bootstraps\\nAverage in Red')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.\nâ„¹ Please use the `fun` argument instead.\n```\n:::\n\n::: {.cell-output-display}\n![](mccv_parameters_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='mccv_parameters_cache/html/unnamed-chunk-5_94cab4449fc7f00c091e9d91e301d36b'}\n\n```{.r .cell-code}\nlibrary(gganimate)\n#install.packages(\"transformr\")\nanimp <- \n    p + \n    transition_time(seed) + \n    labs(title=\"Seed : {frame_time}\")\nanimate(animp,duration = 5, fps = 20, width = 500, height = 500, renderer = gifski_renderer())\n```\n\n::: {.cell-output-display}\n![](mccv_parameters_files/figure-html/unnamed-chunk-5-1.gif)\n:::\n\n```{.r .cell-code}\nanim_save(\"mccv_parameters_animation.gif\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}