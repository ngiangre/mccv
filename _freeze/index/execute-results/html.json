{
  "hash": "6c539532937c0b98009ba77a3252ba45",
  "result": {
    "markdown": "---\ntitle: \"Monte Carlo Cross Validation\"\n---\n\n\n# Evidentiary and interpretable prediction\n\nBinary and Multi-classification algorithm for adverse outcome detection, survival classification, and endpoint prediction (see references for details)\n\n![](MCCV_prediction_scheme.png)\n\n# Objectives of this project\n\n1.  Build the *mccv* python package: easily implement and perform MCCV for learning and prediction tasks.\n2.  Showcase accessibly to build, validate, and interpret MCCV classifiers.\n3.  Demonstrate use in both python and R for diverse community implementations.\n\n# Installation\n\n    mkdir ~/my_directory #choose where to clone the mccv repository\n    cd ~/my_directory\n    git clone https://github.com/ngiangre/mccv.git\n    cd mccv/\n    python3 -m pip install .\n\n# Usage\n\n::: panel-tabset\n# Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\ndata = pd.read_csv('data/data.csv',index_col=0) # Feature column name is 'biomarker' and response column  name is 'status'\ndata.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     status  biomarker\nobs                   \n1         0   1.665731\n2         0  -0.875837\n3         0  -1.391374\n4         0  -0.297352\n5         1   0.189857\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nimport mccv\nmccv_obj = mccv.mccv(num_bootstraps=200)\nmccv_obj.set_X( data.loc[:,['biomarker']] )\nmccv_obj.set_Y( data.loc[:,['status']] )\nmccv_obj.run_mccv()\nmccv_obj.run_permuted_mccv()\n\n#Output\nfor n in mccv_obj.mccv_data:\n    print(n)\n    mccv_obj.mccv_data[n].head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel Learning\n   bootstrap                model  ...  train_roc_auc  validation_roc_auc\n0          0  Logistic Regression  ...       0.529453            0.611111\n1          1  Logistic Regression  ...       0.515235            0.732143\n2          2  Logistic Regression  ...       0.543056            0.400000\n3          3  Logistic Regression  ...       0.519728            0.727273\n4          4  Logistic Regression  ...       0.554054            0.574074\n\n[5 rows x 5 columns]\nFeature Importance\n   bootstrap    feature  importance                model\n0          0  biomarker    1.009705  Logistic Regression\n1          0  Intercept   -0.598575  Logistic Regression\n0          1  biomarker    0.509433  Logistic Regression\n1          1  Intercept   -0.226550  Logistic Regression\n0          2  biomarker    1.598627  Logistic Regression\nPatient Predictions\n     bootstrap                model  y_pred   y_proba  y_true\nobs                                                          \n27           0  Logistic Regression       0  0.384723       1\n87           0  Logistic Regression       1  0.601359       0\n3            0  Logistic Regression       0  0.401320       0\n56           0  Logistic Regression       1  0.512481       1\n76           0  Logistic Regression       0  0.393009       0\nPerformance\n                 model   metric  performance_bootstrap     value\n0  Logistic Regression  roc_auc                      0  0.467487\n1  Logistic Regression  roc_auc                      1  0.467776\n2  Logistic Regression  roc_auc                      2  0.480176\n3  Logistic Regression  roc_auc                      3  0.480679\n4  Logistic Regression  roc_auc                      4  0.475859\n```\n:::\n\n```{.python .cell-code}\nfor n in mccv_obj.mccv_permuted_data:\n    print(n)\n    mccv_obj.mccv_permuted_data[n].head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel Learning\n   bootstrap                model  ...  train_roc_auc  validation_roc_auc\n0          0  Logistic Regression  ...       0.506233            0.642857\n1          1  Logistic Regression  ...       0.492030            0.703704\n2          2  Logistic Regression  ...       0.510135            0.537037\n3          3  Logistic Regression  ...       0.506944            0.703704\n4          4  Logistic Regression  ...       0.589547            0.340909\n\n[5 rows x 5 columns]\nFeature Importance\n   bootstrap    feature  importance                model\n0          0  biomarker   -0.196116  Logistic Regression\n1          0  Intercept    0.079220  Logistic Regression\n0          1  biomarker   -0.628093  Logistic Regression\n1          1  Intercept    0.236617  Logistic Regression\n0          2  biomarker    0.166196  Logistic Regression\nPatient Predictions\n     bootstrap                model  y_pred   y_proba  y_true\nobs                                                          \n27           0  Logistic Regression       1  0.513536       1\n87           0  Logistic Regression       0  0.470809       0\n3            0  Logistic Regression       1  0.510160       0\n56           0  Logistic Regression       0  0.488317       1\n76           0  Logistic Regression       1  0.511844       1\nPerformance\n                 model   metric  performance_bootstrap     value\n0  Logistic Regression  roc_auc                      0  0.440616\n1  Logistic Regression  roc_auc                      1  0.442506\n2  Logistic Regression  roc_auc                      2  0.449941\n3  Logistic Regression  roc_auc                      3  0.440162\n4  Logistic Regression  roc_auc                      4  0.449896\n```\n:::\n:::\n\n\n# R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!requireNamespace(\"readr\")){install.packages(\"readr\")}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required namespace: readr\n```\n:::\n\n```{.r .cell-code}\nlibrary(readr)\ndata <- read_csv(\"data/data.csv\",col_types = c(\"iid\")) #set obs as integer, status as integer, and biomarker as double\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 3\n    obs status biomarker\n  <int>  <int>     <dbl>\n1     1      0     1.67 \n2     2      0    -0.876\n3     3      0    -1.39 \n4     4      0    -0.297\n5     5      1     0.190\n6     6      0     2.20 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!requireNamespace(\"reticulate\")){install.packages(\"reticulate\")}\nmccv = reticulate::import('mccv')\nmccv_obj = mccv$mccv(num_bootstraps = as.integer(200))\n\nX = reticulate::r_to_py(data[,c('obs','biomarker')])\nX = X$set_index(reticulate::r_to_py('obs'))\n\ny = reticulate::r_to_py(data[,c('obs','status')])\ny = y$set_index(reticulate::r_to_py('obs'))\n\nmccv_obj$set_X(X)\nmccv_obj$set_Y(y)\nmccv_obj$run_mccv()\nmccv_obj$run_permuted_mccv()\n\n#Output\nlapply(mccv_obj$mccv_data,head)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in py_to_r.pandas.core.frame.DataFrame(object): index contains\nduplicated values: row names not set\n\nWarning in py_to_r.pandas.core.frame.DataFrame(object): index contains\nduplicated values: row names not set\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$`Model Learning`\n  bootstrap               model test_roc_auc train_roc_auc validation_roc_auc\n1         0 Logistic Regression       1.0000     0.5294525          0.6111111\n2         1 Logistic Regression       0.8000     0.5152355          0.7321429\n3         2 Logistic Regression       1.0000     0.5430556          0.4000000\n4         3 Logistic Regression       0.8750     0.5197279          0.7272727\n5         4 Logistic Regression       0.8125     0.5540541          0.5740741\n6         5 Logistic Regression       1.0000     0.5499325          0.5357143\n\n$`Feature Importance`\n  bootstrap   feature importance               model\n1         0 biomarker  1.0097049 Logistic Regression\n2         0 Intercept -0.5985751 Logistic Regression\n3         1 biomarker  0.5094328 Logistic Regression\n4         1 Intercept -0.2265503 Logistic Regression\n5         2 biomarker  1.5986271 Logistic Regression\n6         2 Intercept -0.9420031 Logistic Regression\n\n$`Patient Predictions`\n  bootstrap               model y_pred   y_proba y_true\n1         0 Logistic Regression      0 0.3847230      1\n2         0 Logistic Regression      1 0.6013587      0\n3         0 Logistic Regression      0 0.4013202      0\n4         0 Logistic Regression      1 0.5124811      1\n5         0 Logistic Regression      0 0.3930090      0\n6         0 Logistic Regression      0 0.4660667      1\n\n$Performance\n                model  metric performance_bootstrap     value\n1 Logistic Regression roc_auc                     0 0.4674874\n2 Logistic Regression roc_auc                     1 0.4677764\n3 Logistic Regression roc_auc                     2 0.4801763\n4 Logistic Regression roc_auc                     3 0.4806793\n5 Logistic Regression roc_auc                     4 0.4758592\n6 Logistic Regression roc_auc                     5 0.4687351\n```\n:::\n\n```{.r .cell-code}\nlapply(mccv_obj$mccv_permuted_data,head)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in py_to_r.pandas.core.frame.DataFrame(object): index contains\nduplicated values: row names not set\n\nWarning in py_to_r.pandas.core.frame.DataFrame(object): index contains\nduplicated values: row names not set\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$`Model Learning`\n  bootstrap               model test_roc_auc train_roc_auc validation_roc_auc\n1         0 Logistic Regression       0.5500     0.5062327          0.6428571\n2         1 Logistic Regression       0.8000     0.4920305          0.7037037\n3         2 Logistic Regression       0.5625     0.5101351          0.5370370\n4         3 Logistic Regression       0.8000     0.5069444          0.7037037\n5         4 Logistic Regression       0.9000     0.5895470          0.3409091\n6         5 Logistic Regression       0.7000     0.5360111          0.5178571\n\n$`Feature Importance`\n  bootstrap   feature  importance               model\n1         0 biomarker -0.19611610 Logistic Regression\n2         0 Intercept  0.07921951 Logistic Regression\n3         1 biomarker -0.62809256 Logistic Regression\n4         1 Intercept  0.23661698 Logistic Regression\n5         2 biomarker  0.16619555 Logistic Regression\n6         2 Intercept -0.01455491 Logistic Regression\n\n$`Patient Predictions`\n  bootstrap               model y_pred   y_proba y_true\n1         0 Logistic Regression      1 0.5135363      1\n2         0 Logistic Regression      0 0.4708091      0\n3         0 Logistic Regression      1 0.5101595      0\n4         0 Logistic Regression      0 0.4883168      1\n5         0 Logistic Regression      1 0.5118443      1\n6         0 Logistic Regression      0 0.4973405      1\n\n$Performance\n                model  metric performance_bootstrap     value\n1 Logistic Regression roc_auc                     0 0.4406164\n2 Logistic Regression roc_auc                     1 0.4425061\n3 Logistic Regression roc_auc                     2 0.4499406\n4 Logistic Regression roc_auc                     3 0.4401616\n5 Logistic Regression roc_auc                     4 0.4498963\n6 Logistic Regression roc_auc                     5 0.4436607\n```\n:::\n:::\n\n:::\n\n# Contribute\n\nPlease do! Reach out to Nick directly (nick.giangreco\\@gmail.com), make an issue, or make a pull request.\n\n# License\n\nThis software is released under the MIT license, which can be found in LICENSE in the root directory of this repository.\n\n# Citation\n\nGiangreco, N.P., Lebreton, G., Restaino, S. et al. Alterations in the kallikrein-kinin system predict death after heart transplant. Sci Rep 12, 14167 (2022). <https://doi.org/10.1038/s41598-022-18573-2>\n\nGiangreco et al. 2021. Plasma kallikrein predicts primary graft dysfunction after heart transplant. Journal of Heart and Lung Transplantation, 40(10), 1199-1211. <https://doi.org/10.1016/j.healun.2021.07.001>.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}